'use strict';

const test = require('ava');

const proxyquire = require('proxyquire');

const sinon = require('sinon');

let sandbox = null;
let db = null;
let uuidArgs = 'xxx';

const metricFixtures = require('./fixtures/metric');

let config = {
  logging: function () {}
};
let metricStub = null;
const singleMetric = Object.assign({}, metricFixtures.single); // const newMetric = {
//   id: 1,
//   type: "memory",
//   value: "705",
//   uuid: "xxx",
//   createdAt: new Date(),
//   updatedAt: new Date()
// };

test.beforeEach(async () => {
  sandbox = sinon.createSandbox();
  metricStub = {
    belongsTo: sinon.spy()
  };
  metricStub.findByAgentUuid = sandbox.stub();
  metricStub.findByAgentUuid.withArgs(uuidArgs).returns(Promise.resolve(metricFixtures.findByTypeAgentUuid(singleMetric)));
  const setupDB = proxyquire('../', {
    './models/metric': () => metricStub
  });
  db = await setupDB(config);
});
test.afterEach(() => {
  sinon.restore();
});
test('Metric', t => {
  t.truthy(db.Metric, 'Agent service should exist');
}); // test.serial("Metric#findByAgentUuid", async t => {
//   t.true(metricStub.findByAgentUuid.called, "FindByAgentUuid should be called");
// });
//# sourceMappingURL=/Users/franndyabreu/Desktop/Platzi-Verse/platziverse-db/node_modules/.cache/ava/fd5930b12f65e6ef1dba4c7c4e9316cd.js.map